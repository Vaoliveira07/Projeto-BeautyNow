{"ast":null,"code":"var _class;\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class CarrinhoService {\n  constructor() {\n    //   private carrinhoItems: any[] = [];\n    //   adicionarAoCarrinho(item: any, quantidade_estoque: number = 1) {\n    //       // Verificar se o item já está no carrinho\n    //       const itemExistente = this.carrinhoItems.find((i) => i.id === item.id);\n    //       if (itemExistente) {\n    //         itemExistente.quantidade += quantidade_estoque;\n    //       } else {\n    //           this.carrinhoItems.push({ ...item, quantidade_estoque });\n    //       }\n    //   }    \n    // removerDoCarrinho(item: any) {\n    //   const index = this.carrinhoItems.indexOf(item);\n    //   if (index !== -1) {\n    //     this.carrinhoItems.splice(index, 1);\n    //   }\n    // }\n    // obterCarrinhoItems() {\n    //   return this.carrinhoItems;\n    // }\n    // limparCarrinho() {\n    //   this.carrinhoItems = [];\n    // }\n    this.chaveCarrinho = 'carrinho';\n    this.carrinhoSubject = new BehaviorSubject({});\n    const carrinhoString = localStorage.getItem(this.chaveCarrinho);\n    const carrinho = carrinhoString ? JSON.parse(carrinhoString) : {};\n    this.carrinhoSubject.next(carrinho);\n  }\n  adicionarAoCarrinho(produto) {\n    const carrinhoAtual = {\n      ...this.carrinhoSubject.value\n    };\n    // Verifica se existe algum pedido ativo\n    const pedidosAtivos = Object.keys(carrinhoAtual);\n    if (pedidosAtivos.length === 0) {\n      // Se não houver pedidos ativos, cria um novo pedido\n      const idPedido = this.gerarIdPedido();\n      carrinhoAtual[idPedido] = [];\n    }\n    // Encontra o primeiro (e, neste caso, único) pedido ativo\n    const idPedidoExistente = pedidosAtivos[0];\n    // Verifica se o produto já está no carrinho\n    const produtoExistente = carrinhoAtual[idPedidoExistente].find(p => p.id === produto.id);\n    if (produtoExistente) {\n      // Se o produto já estiver no carrinho, aumenta a quantidade\n      produtoExistente.quantidade += 1;\n    } else {\n      // Se o produto não estiver no carrinho, adiciona ao carrinho com quantidade inicial de 1\n      carrinhoAtual[idPedidoExistente].push({\n        ...produto,\n        quantidade: 1\n      });\n    }\n    this.atualizarCarrinho(carrinhoAtual);\n  }\n  atualizarCarrinho(carrinho) {\n    localStorage.setItem(this.chaveCarrinho, JSON.stringify(carrinho));\n    this.carrinhoSubject.next(carrinho);\n  }\n  limparCarrinho() {\n    this.atualizarCarrinho({});\n  }\n  // Função auxiliar para gerar um ID de pedido (pode ser ajustada conforme necessário)\n  gerarIdPedido() {\n    return 'pedido_' + Date.now().toString();\n  }\n}\n_class = CarrinhoService;\n_class.ɵfac = function CarrinhoService_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":";AACA,SAASA,eAAe,QAAoB,MAAM;;AAKlD,OAAM,MAAOC,eAAe;EAmC1BC;IAlCA;IAEA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IAEA;IAEA;IACA;IACA;IACA;IACA;IAEA;IAEA;IACA;IAEA;IAEA;IACA;IACQ,kBAAa,GAAG,UAAU;IAE1B,oBAAe,GAA8C,IAAIF,eAAe,CAA2B,EAAE,CAAC;IAGpH,MAAMG,cAAc,GAAGC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACC,aAAa,CAAC;IAC/D,MAAMC,QAAQ,GAAGJ,cAAc,GAAGK,IAAI,CAACC,KAAK,CAACN,cAAc,CAAC,GAAG,EAAE;IACjE,IAAI,CAACO,eAAe,CAACC,IAAI,CAACJ,QAAQ,CAAC;EACrC;EAEOK,mBAAmB,CAACC,OAAY;IACrC,MAAMC,aAAa,GAAG;MAAE,GAAG,IAAI,CAACJ,eAAe,CAACK;IAAK,CAAE;IAEvD;IACA,MAAMC,aAAa,GAAGC,MAAM,CAACC,IAAI,CAACJ,aAAa,CAAC;IAEhD,IAAIE,aAAa,CAACG,MAAM,KAAK,CAAC,EAAE;MAC9B;MACA,MAAMC,QAAQ,GAAG,IAAI,CAACC,aAAa,EAAE;MACrCP,aAAa,CAACM,QAAQ,CAAC,GAAG,EAAE;;IAG9B;IACA,MAAME,iBAAiB,GAAGN,aAAa,CAAC,CAAC,CAAC;IAE1C;IACA,MAAMO,gBAAgB,GAAGT,aAAa,CAACQ,iBAAiB,CAAC,CAACE,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAACC,EAAE,KAAKb,OAAO,CAACa,EAAE,CAAC;IAE1F,IAAIH,gBAAgB,EAAE;MACpB;MACAA,gBAAgB,CAACI,UAAU,IAAI,CAAC;KACjC,MAAM;MACL;MACAb,aAAa,CAACQ,iBAAiB,CAAC,CAACM,IAAI,CAAC;QAAE,GAAGf,OAAO;QAAEc,UAAU,EAAE;MAAC,CAAE,CAAC;;IAGtE,IAAI,CAACE,iBAAiB,CAACf,aAAa,CAAC;EACvC;EAEQe,iBAAiB,CAACtB,QAAkC;IAC1DH,YAAY,CAAC0B,OAAO,CAAC,IAAI,CAACxB,aAAa,EAAEE,IAAI,CAACuB,SAAS,CAACxB,QAAQ,CAAC,CAAC;IAClE,IAAI,CAACG,eAAe,CAACC,IAAI,CAACJ,QAAQ,CAAC;EACrC;EAEAyB,cAAc;IACZ,IAAI,CAACH,iBAAiB,CAAC,EAAE,CAAC;EAC5B;EAEA;EACQR,aAAa;IACnB,OAAO,SAAS,GAAGY,IAAI,CAACC,GAAG,EAAE,CAACC,QAAQ,EAAE;EAC1C;;SAlFWlC,eAAe;;mBAAfA,MAAe;AAAA;;SAAfA,MAAe;EAAAmC,SAAfnC,MAAe;EAAAoC,YAFd;AAAM","names":["BehaviorSubject","CarrinhoService","constructor","carrinhoString","localStorage","getItem","chaveCarrinho","carrinho","JSON","parse","carrinhoSubject","next","adicionarAoCarrinho","produto","carrinhoAtual","value","pedidosAtivos","Object","keys","length","idPedido","gerarIdPedido","idPedidoExistente","produtoExistente","find","p","id","quantidade","push","atualizarCarrinho","setItem","stringify","limparCarrinho","Date","now","toString","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Letticia_Tonon\\Downloads\\Vanessa\\Vanessa\\fontend\\src\\app\\service\\carrinho.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CarrinhoService {\r\n  //   private carrinhoItems: any[] = [];\r\n\r\n  //   adicionarAoCarrinho(item: any, quantidade_estoque: number = 1) {\r\n  //       // Verificar se o item já está no carrinho\r\n  //       const itemExistente = this.carrinhoItems.find((i) => i.id === item.id);\r\n    \r\n  //       if (itemExistente) {\r\n  //         itemExistente.quantidade += quantidade_estoque;\r\n  //       } else {\r\n  //           this.carrinhoItems.push({ ...item, quantidade_estoque });\r\n  //       }\r\n  //   }    \r\n\r\n  // removerDoCarrinho(item: any) {\r\n    \r\n  //   const index = this.carrinhoItems.indexOf(item);\r\n  //   if (index !== -1) {\r\n  //     this.carrinhoItems.splice(index, 1);\r\n  //   }\r\n  // }\r\n\r\n  // obterCarrinhoItems() {\r\n    \r\n  //   return this.carrinhoItems;\r\n  // }\r\n\r\n  // limparCarrinho() {\r\n    \r\n  //   this.carrinhoItems = [];\r\n  // }\r\n  private chaveCarrinho = 'carrinho';\r\n\r\n  private carrinhoSubject: BehaviorSubject<{ [key: string]: any[] }> = new BehaviorSubject<{ [key: string]: any[] }>({});\r\n\r\n  constructor() {\r\n    const carrinhoString = localStorage.getItem(this.chaveCarrinho);\r\n    const carrinho = carrinhoString ? JSON.parse(carrinhoString) : {};\r\n    this.carrinhoSubject.next(carrinho);\r\n  }\r\n\r\n  public adicionarAoCarrinho(produto: any): void {\r\n    const carrinhoAtual = { ...this.carrinhoSubject.value };\r\n  \r\n    // Verifica se existe algum pedido ativo\r\n    const pedidosAtivos = Object.keys(carrinhoAtual);\r\n  \r\n    if (pedidosAtivos.length === 0) {\r\n      // Se não houver pedidos ativos, cria um novo pedido\r\n      const idPedido = this.gerarIdPedido();\r\n      carrinhoAtual[idPedido] = [];\r\n    }\r\n  \r\n    // Encontra o primeiro (e, neste caso, único) pedido ativo\r\n    const idPedidoExistente = pedidosAtivos[0];\r\n  \r\n    // Verifica se o produto já está no carrinho\r\n    const produtoExistente = carrinhoAtual[idPedidoExistente].find((p) => p.id === produto.id);\r\n  \r\n    if (produtoExistente) {\r\n      // Se o produto já estiver no carrinho, aumenta a quantidade\r\n      produtoExistente.quantidade += 1;\r\n    } else {\r\n      // Se o produto não estiver no carrinho, adiciona ao carrinho com quantidade inicial de 1\r\n      carrinhoAtual[idPedidoExistente].push({ ...produto, quantidade: 1 });\r\n    }\r\n  \r\n    this.atualizarCarrinho(carrinhoAtual);\r\n  }\r\n\r\n  private atualizarCarrinho(carrinho: { [key: string]: any[] }): void {\r\n    localStorage.setItem(this.chaveCarrinho, JSON.stringify(carrinho));\r\n    this.carrinhoSubject.next(carrinho);\r\n  }\r\n\r\n  limparCarrinho(): void {\r\n    this.atualizarCarrinho({});\r\n  }\r\n\r\n  // Função auxiliar para gerar um ID de pedido (pode ser ajustada conforme necessário)\r\n  private gerarIdPedido(): string {\r\n    return 'pedido_' + Date.now().toString();\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}